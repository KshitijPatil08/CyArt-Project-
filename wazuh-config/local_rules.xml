<group name="usb_devices,local">
  <!-- USB Device Connected (Windows) -->
  <rule id="100001" level="3">
    <if_sid>60009</if_sid>
    <field name="win.system.eventID">^2003$|^20001$</field>
    <description>USB device connected on Windows system</description>
    <group>usb_connected,pci_dss_10.6.1,</group>
  </rule>

  <!-- USB Device Removed (Windows) -->
  <rule id="100002" level="3">
    <if_sid>60009</if_sid>
    <field name="win.system.eventID">^2102$|^20003$</field>
    <description>USB device removed on Windows system</description>
    <group>usb_removed,</group>
  </rule>

  <!-- USB Storage Device Detected (Linux) -->
  <rule id="100003" level="5">
    <if_sid>2902</if_sid>
    <match>usb-storage</match>
    <description>USB storage device detected on Linux system</description>
    <group>usb_storage,pci_dss_10.6.1,</group>
  </rule>

  <!-- USB Mass Storage Connected (Linux) -->
  <rule id="100004" level="5">
    <if_sid>2902</if_sid>
    <regex>sd[b-z].*USB</regex>
    <description>USB mass storage device connected</description>
    <group>usb_storage,</group>
  </rule>

  <!-- USB HID Device Connected (Keyboard/Mouse) -->
  <rule id="100005" level="2">
    <if_sid>2902,60009</if_sid>
    <match>HID|input|keyboard|mouse</match>
    <description>USB HID device (keyboard/mouse) connected</description>
    <group>usb_hid,peripheral,</group>
  </rule>

  <!-- Unauthorized USB Device -->
  <rule id="100010" level="10">
    <if_sid>100001,100003</if_sid>
    <time>18:00-08:00</time>
    <description>USB device connected outside business hours!</description>
    <group>usb_unauthorized,pci_dss_10.6.1,</group>
  </rule>
</group>
